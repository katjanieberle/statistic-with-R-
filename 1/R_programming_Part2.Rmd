---
title: "R - Programmiergrundlagen"
author: "Dr. Katja Nieberle"
date: "2026-03-15"
output:
  html_document: default
  pdf_document: default
---

## Arbeitsverzeichnis (Working Directory)

Das **Working Directory** ist der Ordner, in dem R nach Dateien sucht und speichert.Man sieht die auch direkt im RStudio in der Files "Ecke" (typischerweise rechts unten).

```{r wd, eval = FALSE}
# Aktuelles Working Directory anzeigen
getwd()

# Working Directory ändern
# setwd("C:/Users/DeinName/Dokumente/projekt")
```

**Tipp:** Bei RStudio-Projekten wird das Working Directory automatisch auf den Projektordner gesetzt – besser als `setwd()`!

---

## R als Taschenrechner

R kann matematische Operationen

```{r math}
1 + 2 * 3              # 7 (Reihenfolge beachten!)
sum(1, 2, 3)           # 6
2 * 5^2 - 10 * 5       # 230
4 * sin(pi / 2)        # 4
0 / 0                  # NaN (Not a Number)
```

## Objektzuweisung und Ausgabe

Verwende immer `<-` (nicht `=`):

```{r assign}
x1 <- 3.25             # Zuweisung
x2 <- 5.6 - 5

x1                     # Implizite Ausgabe (letzter Befehl)
print(x1)              # Explizite Ausgabe
print(x1 + x2)         # Berechnung + Ausgabe
```

---

## Objekte, Klassen und Datentypen

```{r obj}
a <- 5; mode(a)        # numeric

b <- "Text"; mode(b)   # character

c <- TRUE; mode(c)     # logical

# Spezialwerte
d <- NA                # Not Available
e <- NULL              # Leeres Objekt

# Vektor
avec <- c(1, 2, 3, 4, 5); mode(avec)  # numeric
avec

# Matrix
X <- matrix(1:6, nrow = 2)
mode(X)                # matrix
X
```

## Prüfung

```{r check}
is.numeric(a)          # TRUE
is.na(d)               # TRUE
```

## Arbeiten mit NAs 

```{r nan}
x <- c(2, NA, 4)
is.na(x)               # TRUE/NA/...
sum(is.na(x))          # 1 NA-Wert

mean(x, na.rm = TRUE)  # Ignoriere NA
# na.omit(df)          # Für Data Frames
```

## Indizierung in Vektoren

```{r vec}
x <- c(3, 6, 9, 8, 4, 1, 2)

x[c(1, 3)]             # 1. und 3. Element: 3, 9
x[x < 4]               # Logischer Filter

length(x)              # 7
sum(x < 4)             
which(x < 4)           # Positionen: 1, 6, 7
```

## Matrizen und Dataframes

```{r mat}
Einkaufen <- data.frame(
  Produkt = c("Apfelsaft", "Quark"),
  Menge   = c(4, 2)
)

str(Einkaufen)         # Struktur
Einkaufen[, "Menge"]   # Spalte Menge
Einkaufen[Einkaufen$Menge > 2, ]  # Filter
```

---

## Funktionen in R

**Syntax:** `funktion(arg1 = wert1, arg2 = wert2)`

**Beispiele: `print()`, `mean()` **

```{r fct}
a <- 7
print(a)               # print(7)

mean(c(1, 2, 3))       # 2
mean(c(1, NA, 3), na.rm = TRUE)  # 2
```

**Argumente haben oft Default Eingaben:** (z.B. na.rm = FALSE).


**R-Hilfe:** `?` und `??`

```{r hlp, eval = FALSE}
?mean                  # Hilfe zu mean()
??durchschnitt         # Suche über alle Pakete
help(mean)             # Alternative zu ?
help.search("mean")    # Apropos-Suche
```

**In RStudio:**

- `?mean` - Help-Pane öffnet sich

- `Strg + Shift + Space` Argument-Hilfe

- `F1` Hilfe zu markiertem Code

**R Pakete:** Pakete erweitern R um Funktionen und Daten:

- Installieren (einmalig): `install.packages("openxlsx")`

- Laden (pro Session): `library(openxlsx)` oder `require(openxlsx)`

--- 

## Bedingungen `if`,  `else`, `ifelse`

```{r cond1}
# Einzelbedingung
x <- 7
if (x > 5) {
  print("x ist groß")
} else {
  print("x ist klein")
}

# Vektorwertig (wichtig!)
score <- c(85, 92, 78, 95)
ifelse(score > 90, "Sehr gut", "Gut")
```

## Schleifen: `for`, `while`, `repeat`

```{r cond2}
# for: bekannte Anzahl
umsatz <- c(100, 150, 200)
for (i in umsatz) {
  print(paste("Umsatz:", i))
}

# while: unbekannte Anzahl
i <- 1
while (i <= 3) {
  print(i)
  i <- i + 1  # WICHTIG!
}

# repeat mit break
i <- 0
repeat {
  i <- i + 1
  if (i > 3) break
  print(i)
}
```
--- 

## Workspace-Management - Verwalte deine Objekte
```{r wd2, eval = FALSE}
ls() # Alle Objekte der entsprechenden directory auflisten
rm(blabla) # Objekt löschen
getwd() # get working directory - Arbeitsverzeichnis
setwd("C:/data") # set working directory - Setze das Arbeitsverzeichnis
```

---

# Übungsaufgaben:

1. Berechne `(3 + 5) * 2 - 4`. Weise das Ergebnis der Variable `result` zu. Gebe es mit `print()` und implizit aus. Erweitere um Variable `f <- 1.1` und multipliziere mit dem `result`.

2. Erstelle Vektor `sale <- c(10, NA, 15, 20, 30, 40, NA, 90)`. Prüfe `mode(sale)`, und `is.na(sale)`. Berechne `mean(sale, na.rm=TRUE)`. Was für Berechnungen hast Du genau durchgeführt?

3. Erstelle den Vektor `price <- c(2.5, 1.8, 3.2, 0.9, 4.1, 8.7, 9.1)`.
- Extrahiere 2. und 4. Element.
- Filtere `price > 2`.
- Berechne die Summe der Elemente mit `sum()`.
- Berechne die Summe der Elemente > 2.

4. Installiere `dplyr` (falls nicht vorhanden). Lade mit `library(dplyr)` und `require(dplyr)`.

5. Erstelle Funktion `calculation(sales, rate=0.19)`. Die Funktion berechnen die Umsatzsteuer als `sales * (1+rate)`. Teste mit `calculation(1000)` und mit `calculation(1000, 0.2)`.

6. Für einen sortierten Vektor `sales <- c(100,150,170,190,250)`
- schreibe eine for-Schleife, um jeden Umsatz aus `sales` zu verdoppeln und zu printen.
- schreibe eine while-Schleife, die den Umsatz solange verdoppelt und printen, solange die Werte < 200 sind.
- schreibe eine for-Schleife und entscheide innerhalb der Schleife mit einer `ìf-than-else` Bedingung: Die Werte > 200 sollen einzeln geprintet werden; die Werte <= 200 sollen doppelt geprintet werden.


# Lösungen:

## 1.

```{r ex1, eval=FALSE}
result <- (3 + 5) * 2 - 4 # 14
print(result) # 14
result # 14 (implizit)

f <- 1.1
result * f # 15.4

```
## 2.
```{r ex2, eval=FALSE}
sale <- c(10, NA, 15, 20, 30, 40, NA, 90)
mode(sale) # numeric
is.na(sale)
mean(sale, na.rm=TRUE)
```
## 3.
```{r ex3, eval=FALSE}
price <- c(2.5, 1.8, 3.2, 0.9, 4.1, 8.7, 9.1)
price[c(2,4)]
price[price > 2]
sum(price > 2)
```
## 4.
```{r ex4, eval=FALSE}
install.packages("dplyr") # Falls nötig
library(dplyr) # Kein Return
require(dplyr) # TRUE
```
## 5.
```{r ex5, eval=FALSE}
calculation <- function(sales, rate=0.19) {
result <- sales * (1 + rate)
return(result)
}
calculation(1000)
calculation(1000, 0.2)


```
## 6.
```{r ex6, eval=FALSE}
sales <- c(100,150,170,190,250,300)
for(i in sales) {
print(i * 2)
}

i <- 1 # Startwert (erster sales-Wert)
while(sales[i] < 200) {
print(sales[i] * 2)
i = i + 1
}

for(i in sales) {
if (i > 200)
print(i)
else print (i*2)
}

```